<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Manuela Metais{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    {% block extra_css %}{% endblock %}
</head>
<body>
    <!-- Header Principal -->
    <div class="main-header">
        <div class="header-container">
            <div class="logo-section">
                <div class="logo-icon">‚ôªÔ∏è</div>
                <div class="logo-text">
                    <h1>MANUELA METAIS</h1>
                    <p>Sistema de Gest√£o de Reciclagem</p>
                </div>
            </div>
            
            <div class="header-actions">
                <div class="search-box">
                    <input type="text" placeholder="Buscar..." id="global-search">
                    <span class="search-icon">üîç</span>
                </div>
                
                <div class="notification-icon" title="Notifica√ß√µes">
                    <span class="icon">üîî</span>
                    <span class="badge">3</span>
                </div>
                
                <div class="user-menu">
                    <div class="user-avatar">üë§</div>
                    <div class="user-info">
                        <span class="user-name">Usu√°rio</span>
                        <span class="user-role">Administrador</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Navega√ß√£o -->
    <nav class="main-nav">
        <div class="nav-container">
            <div class="nav-group">
                <a href="/" class="nav-item {% if request.path == '/' %}active{% endif %}">
                    <span class="nav-icon">üìä</span>
                    <span class="nav-label">Dashboard</span>
                </a>
            </div>

            <div class="nav-divider"></div>

            <div class="nav-group">
                <span class="nav-group-title">CADASTROS</span>
                <a href="/clientes" class="nav-item {% if 'clientes' in request.path %}active{% endif %}">
                    <span class="nav-icon">üë•</span>
                    <span class="nav-label">Clientes</span>
                </a>
                <a href="/fornecedores" class="nav-item {% if 'fornecedores' in request.path %}active{% endif %}">
                    <span class="nav-icon">üè≠</span>
                    <span class="nav-label">Fornecedores</span>
                </a>
                <a href="/funcionarios" class="nav-item {% if 'funcionarios' in request.path %}active{% endif %}">
                    <span class="nav-icon">üë®‚Äçüíº</span>
                    <span class="nav-label">Funcion√°rios</span>
                </a>
                <a href="/produtos" class="nav-item {% if 'produtos' in request.path %}active{% endif %}">
                    <span class="nav-icon">üì¶</span>
                    <span class="nav-label">Produtos</span>
                </a>
            </div>

            <div class="nav-divider"></div>

            <div class="nav-group">
                <span class="nav-group-title">OPERACIONAL</span>
                <a href="/estoque" class="nav-item {% if 'estoque' in request.path %}active{% endif %}">
                    <span class="nav-icon">üìä</span>
                    <span class="nav-label">Estoque</span>
                </a>
                <a href="/pedidos-compra" class="nav-item {% if 'pedidos-compra' in request.path %}active{% endif %}">
                    <span class="nav-icon">üõí</span>
                    <span class="nav-label">Pedidos de Compra</span>
                </a>
            </div>

            <div class="nav-divider"></div>

            <div class="nav-group">
                <span class="nav-group-title">FINANCEIRO</span>
                <a href="/contas-receber" class="nav-item {% if 'contas-receber' in request.path %}active{% endif %}">
                    <span class="nav-icon">üí∞</span>
                    <span class="nav-label">Contas a Receber</span>
                    <span class="nav-badge success">5</span>
                </a>
                <a href="/contas-pagar" class="nav-item {% if 'contas-pagar' in request.path %}active{% endif %}">
                    <span class="nav-icon">üí∏</span>
                    <span class="nav-label">Contas a Pagar</span>
                    <span class="nav-badge danger">2</span>
                </a>
                <a href="/gastos" class="nav-item {% if 'gastos' in request.path %}active{% endif %}">
                    <span class="nav-icon">üßæ</span>
                    <span class="nav-label">Gastos</span>
                </a>
            </div>
        </div>
    </nav>

    <!-- Conte√∫do Principal -->
    <main class="main-content">
        <!-- Breadcrumb -->
        <div class="breadcrumb">
            <a href="/">In√≠cio</a>
            {% block breadcrumb %}{% endblock %}
        </div>

        <!-- √Årea de Conte√∫do -->
        <div class="content-area">
            {% block content %}{% endblock %}
        </div>
    </main>

    <!-- Toast de Notifica√ß√µes -->
    <div id="toast-container"></div>

    <!-- Modal de Confirma√ß√£o Global -->
    <div id="confirm-modal" class="modal">
        <div class="modal-content modal-sm">
            <div class="modal-header">
                <h3 id="confirm-title">Confirmar a√ß√£o</h3>
                <button class="close-modal" onclick="closeConfirmModal()">&times;</button>
            </div>
            <div class="modal-body">
                <p id="confirm-message">Tem certeza que deseja continuar?</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeConfirmModal()">Cancelar</button>
                <button class="btn btn-primary" id="confirm-action">Confirmar</button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="main-footer">
        <div class="footer-content">
            <div class="footer-left">
                <p>&copy; 2026 Manuela Metais. Sistema de Gest√£o de Reciclagem.</p>
            </div>
            <div class="footer-right">
                <a href="#" class="footer-link">Suporte</a>
                <a href="#" class="footer-link">Documenta√ß√£o</a>
                <a href="#" class="footer-link">Vers√£o 1.0</a>
            </div>
        </div>
    </footer>

    <!-- Scripts Base -->
    <script>
        // Toast notifications
        function showToast(message, type = 'success') {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            
            const icons = {
                success: '‚úì',
                error: '‚úï',
                warning: '‚ö†',
                info: '‚Ñπ'
            };
            
            toast.innerHTML = `
                <span class="toast-icon">${icons[type]}</span>
                <span class="toast-message">${message}</span>
            `;
            
            container.appendChild(toast);
            
            setTimeout(() => toast.classList.add('show'), 10);
            
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // Modal de confirma√ß√£o
        let confirmCallback = null;

        function showConfirm(title, message, callback) {
            document.getElementById('confirm-title').textContent = title;
            document.getElementById('confirm-message').textContent = message;
            document.getElementById('confirm-modal').classList.add('active');
            confirmCallback = callback;
        }

        function closeConfirmModal() {
            document.getElementById('confirm-modal').classList.remove('active');
            confirmCallback = null;
        }

        document.getElementById('confirm-action').addEventListener('click', () => {
            if (confirmCallback) {
                confirmCallback();
            }
            closeConfirmModal();
        });

        // Busca global
        document.getElementById('global-search').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                const query = e.target.value;
                if (query.trim()) {
                    console.log('Buscar:', query);
                    showToast('Funcionalidade de busca em desenvolvimento', 'info');
                }
            }
        });

        // Fechar modais ao clicar fora
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.classList.remove('active');
                }
            });
        });

        // Loading state helper
        function setLoading(element, isLoading) {
            if (isLoading) {
                element.disabled = true;
                element.dataset.originalText = element.textContent;
                element.innerHTML = '<span class="spinner"></span> Carregando...';
            } else {
                element.disabled = false;
                element.textContent = element.dataset.originalText;
            }
        }

        // Format currency
        function formatCurrency(value) {
            return new Intl.NumberFormat('pt-BR', {
                style: 'currency',
                currency: 'BRL'
            }).format(value);
        }

        // Format date
        function formatDate(date) {
            return new Intl.DateTimeFormat('pt-BR').format(new Date(date));
        }

        // API Helper
        async function apiRequest(url, options = {}) {
            try {
                const response = await fetch(url, {
                    ...options,
                    headers: {
                        'Content-Type': 'application/json',
                        ...options.headers
                    }
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                return await response.json();
            } catch (error) {
                console.error('API Error:', error);
                showToast('Erro ao processar solicita√ß√£o', 'error');
                throw error;
            }
        }
    </script>

    {% block extra_js %}{% endblock %}
</body>
</html>
